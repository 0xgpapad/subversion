#!/bin/sh

# QSH utility script for converting all python test scripts from utf-8 to
# ebcidc.
#
# usage: make_python_ebcdic svn_root_dir
#        Where svn_root_dir is the root directory of the subversion source
#        code tree.

ROOTDIR=$1

cd $ROOTDIR

QSH_REDIRECTION_TEXTDATA=Y

convert_file()
{
  TARGET=$1
  if attr $TARGET CCSID > /dev/null
    then
      if attr $TARGET CCSID | grep "37" > /dev/null
        then echo "Python script '$ROOTDIR/$TARGET' already encoded in ebcdic."                                           
      else
        echo "Converting script '$ROOTDIR/$TARGET' from utf-8 to ebcdic."
        cat $TARGET > $TARGET.37.py
        rm -f $TARGET
        mv $TARGET.37.py $TARGET
      fi
    else
      echo "Expected Python script '$ROOTDIR/$TARGET' not found!"
  fi
}

convert_file as400test.py
convert_file build/run_tests.py
convert_file subversion/tests/svn/svntest/__init__.py
convert_file subversion/tests/svn/svntest/actions.py
convert_file subversion/tests/svn/svntest/entry.py
convert_file subversion/tests/svn/svntest/main.py
convert_file subversion/tests/svn/svntest/testcase.py
convert_file subversion/tests/svn/svntest/tree.py
convert_file subversion/tests/svn/svntest/wc.py
convert_file subversion/tests/svn/autoprop_tests.py 
convert_file subversion/tests/svn/basic_tests.py    
convert_file subversion/tests/svn/blame_tests.py    
convert_file subversion/tests/svn/cat_tests.py      
convert_file subversion/tests/svn/commit_tests.py   
convert_file subversion/tests/svn/copy_tests.py     
convert_file subversion/tests/svn/diff_tests.py     
convert_file subversion/tests/svn/ebcdic.py         
convert_file subversion/tests/svn/export_tests.py   
convert_file subversion/tests/svn/externals_tests.py
convert_file subversion/tests/svn/getopt_tests.py   
convert_file subversion/tests/svn/history_tests.py  
convert_file subversion/tests/svn/import_tests.py    
convert_file subversion/tests/svn/lock_tests.py      
convert_file subversion/tests/svn/log_tests.py       
convert_file subversion/tests/svn/merge_tests.py     
convert_file subversion/tests/svn/prop_tests.py      
convert_file subversion/tests/svn/revert_tests.py    
convert_file subversion/tests/svn/schedule_tests.py  
convert_file subversion/tests/svn/special_tests.py   
convert_file subversion/tests/svn/stat_tests.py      
convert_file subversion/tests/svn/svnadmin_tests.py  
convert_file subversion/tests/svn/svnlook_tests.py   
convert_file subversion/tests/svn/svnversion_tests.py
convert_file subversion/tests/svn/switch_tests.py    
convert_file subversion/tests/svn/trans_tests.py     
convert_file subversion/tests/svn/update_tests.py    
convert_file subversion/tests/svn/utf8_tests.py   
convert_file subversion/tests/libsvn_subr/target-test.py

exit 0